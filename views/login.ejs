<!DOCTYPE html>
<html lang="ko">

<head>
  <meta charset="UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>로그인</title>

  <!-- favicon -->
  <link rel="shoctcut icon" type="image/x-icon" href="../static/img/favicon/favicon.ico">

  <!-- axios CDN -->
  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <link rel="stylesheet" href="/static/css/login.css" />

  <!-- font CDN -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+KR&display=swap" rel="stylesheet" />

  <!-- SweatAlert CDN -->
  <script src="https://unpkg.com/sweetalert/dist/sweetalert.min.js"></script>

  <style>
    body {
      background-color: rgb(26, 31, 39);
      color: white;
      font-family: "Noto Sans KR", sans-serif;
    }

    form {
      width: 400px;
      margin: 0 auto;
      display: flex;
      flex-direction: column;
    }

    .login-form p {
      text-align: center;
      font-size: 25px;
      color: white;
    }

    .back-main a {
      height: 50px;
      padding-left: 20px;
      display: flex;
      align-items: center;
      text-decoration: none;
      color: white;
    }

    .login-form label {
      width: 130px;
      margin: 10px;
    }

    .login-form input {
      height: 40px;
      border: 1px solid rgb(221, 221, 221);
      border-radius: 4px;
      padding: 0px 11px 0px 15px;
      background-color: transparent;
      color: white;
    }

    .login-form button,
    .login-form a {
      width: 100%;
      height: 50px;
      text-decoration: none;
      color: white;
      background-color: #ff9671;
      font-size: 16px;
      border-radius: 4px;
      font-weight: bold;
    }

    .login-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .login-form a {
      display: flex;
      align-items: center;
      justify-content: center;
      background-color: #e27d8e;
    }
  </style>
</head>

<body>
  <div class="back-main">
    <a href="/">뒤로가기</a>
  </div>
  <!-- <form name="form_info" action="/profile" method="POST">
    <input type="hidden" name="userid" />
  </form> -->

  <form name="login-form" class="login-form">
    <p>로그인</p>
    <!-- <div class="login-id login"> -->
    <label for="userid">아이디</label>
    <input id="userid" type="text" name="userid" required /><br />
    <!-- </div> -->

    <!-- <div class="login-pw login"> -->
    <label for="password">비밀번호</label>
    <input id="password" type="password" name="pw" required /><br /><br />
    <!-- </div> -->
    <div class="login-btn">
      <button type="button" onclick="login();">Login</button><br />
      <a href="/register">회원가입 하기</a>
    </div>
  </form>

  <script>
    function login() {
      const formLogin = document.forms["login-form"];

      if (!formLogin.checkValidity()) {
        formLogin.reportValidity();
        return;
      }

      axios({
          method: "POST",
          url: "/signin",
          data: {
            userid: formLogin.userid.value,
            pw: formLogin.pw.value,
          },
        })
        .then((res) => {
          return res.data;
        })
        .then((data) => {
          console.log(data.islogin);
          if (data.islogin) {
          

            swal('로그인 성공!', data.nick + "님 로그인되었습니다.", 'success')
              .then(function() {
                document.location.href = "/";
              })

          } else {
            swal('로그인 실패!', "아이디 또는 비밀번호를 확인해주세요", 'warning')
              .then(function() {
                formLogin.reset();
              })

          }
        });
    }
  </script>
</body>

<script src="https://code.jquery.com/jquery-3.6.1.min.js" integrity="sha256-o88AwQnZB+VDvE9tvIXrMQaPlFFSUTR+nldQm1LuPXQ=" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.2/dist/js/bootstrap.bundle.min.js"></script>

</html>
